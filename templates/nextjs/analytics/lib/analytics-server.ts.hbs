{{#if serverSide}}
{{#if isPostHog}}
import { PostHog } from "posthog-node";

const posthog = new PostHog(process.env.POSTHOG_API_KEY!, {
  host: process.env.POSTHOG_HOST || "https://app.posthog.com",
});

export async function trackServerEvent(
  distinctId: string,
  event: string,
  properties?: Record<string, any>
) {
  posthog.capture({ distinctId, event, properties });
}

export async function shutdownAnalytics() {
  await posthog.shutdown();
}
{{else}}
export async function trackServerEvent(
  distinctId: string,
  event: string,
  properties?: Record<string, any>
) {
  if (process.env.NODE_ENV === "development") {
    console.log("[Server Analytics]", { distinctId, event, properties });
  }
  // TODO: Send to your analytics provider's server-side API
}

export async function shutdownAnalytics() {}
{{/if}}
{{else}}
// Server-side analytics not enabled.
// Enable with: node scripts/scaffold.js add-analytics --serverSide=true
export async function trackServerEvent(
  _distinctId: string,
  _event: string,
  _properties?: Record<string, any>
) {}
export async function shutdownAnalytics() {}
{{/if}}
